# AS-REP roasting

{% embed url="https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-kile/b4af186e-b2ff-43f9-b18e-eedb366abf13" %}

{% embed url="https://www.picussecurity.com/resource/blog/as-rep-roasting-attack-explained-mitre-attack-t1558.004" %}

{% embed url="https://jumpcloud.com/it-index/what-is-as-rep-roasting" %}

### What is AS-REP roasting?

#### Pre-authentication enabled

In a standard Kerberos authentication flow (with pre-authentication active), a user initiates the process by sending an **authentication service request** (**KRB\_AS\_REQ**) to the KDC, with a timestamp encrypted using its own password. The KDC will validate the timestamp (using its stored version of the user's password), and if valid, response with an **authentication service response** (**KRB\_AS\_REP**) containing a TGT.

#### Pre-authentication disabled

However, with pre-authentication disabled, the KDC prematurely sends an **authentication service response** (**KRB\_AS\_REP**) upon receiving the **KRB\_AS\_REQ** for a particular user acount, without requiring any valid authentication details. This response includes a segment encrypted with a user's password hash (the user will be specified in the **KRB\_AS\_REQ**). This allows an an attacker to extract the encrypted data without knowledge of any authentication credentials, to perform offline brute-force or dictionary attacks to obtain the user's password.

### (1) Retrieve a list of user accounts

First, we have to retrieve a list of user accounts in the AD network:

```powershell
PS> 
```

### (2) Enumerate user accounts with pre-authentication disabled, and perform AS-REQ

### (3) Offline cracking







