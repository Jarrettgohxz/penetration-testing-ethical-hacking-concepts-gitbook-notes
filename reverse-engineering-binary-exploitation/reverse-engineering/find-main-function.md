# Find main function

There are times when de-compiling a binary (eg. Ghidra) may not directly reveal the address of the `main` function. This may happen as a result of a few things:

* **Stripped symbols**: the symbol table was removed, so `main` has no name
* **`main` is invoked indirectly** (via `__libc_start_main` or via `.init_array` constructors)



In this section, I will discuss a few techniques to discover the starting address of the `main` function.

### Debugging (GDB)

1. Discover entry address

```shellscript
$ readelf -l <bin_file> | grep -i Entry
Entry point 0xxxx
```

...

```shellscript
$ objdump -d --disassemble-all -M intel <bin_file> | grep -n '__libc_start_main'
```

...

2. Walk through and analyse disassembly&#x20;

```shellscript
gdb <bin_file>

gdb> run # load the relocated address

gdb> info files

gdb> disass *0x..., *0x...+100
gdb> break *0x...

gdb> stepi # until the first "call" command
gdb> info registers rdi # first argument - contains the addres of the "main" function

```



### Ghidra

1. Look for `entry` function

...

2. Look for `__libc_start_main`&#x20;

...

<figure><img src="../../.gitbook/assets/image.png" alt=""><figcaption></figcaption></figure>

