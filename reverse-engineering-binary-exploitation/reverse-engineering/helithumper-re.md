# Helithumper RE

{% embed url="https://github.com/guyinatuxedo/nightmare/blob/master/modules/03-beginner_re/helithumper_re/rev" %}

### Ghidra

#### 1. Decompiled "main"

```c
bool main(void)
{
  char *pcVar1;
  undefined8 uVar2;
  bool bVar3;
  
  pcVar1 = (char *)calloc(0x32,1);
  puts(&DAT_00102008);
  __isoc99_scanf(&DAT_0010203b,pcVar1);
  uVar2 = validate(pcVar1);
  bVar3 = (int)uVar2 == 0;
  if (bVar3) {
    puts(&DAT_00102050);
  }
  else {
    puts("Right this way...");
  }
  return bVar3;
}
```

#### 2. Steps in cleaning up the "main" code

**2.1 Variables**

**...**

**2.2 Arguments**

**...**

<figure><img src="../../.gitbook/assets/image (84).png" alt=""><figcaption></figcaption></figure>



**2.3 ...**

...

### GDB

```shellscript
 strings rev
/lib64/ld-linux-x86-64.so.2
libc.so.6
puts
xxxx
xxxx
Welcome to the Salty Spitoon
, How tough are ya?
Right this way...
Yeah right. Back to Weenie Hut Jr
 with ya
;*3$"
xxxx
xxxx
```

```shellscript
$ gdb rev
gdn> break main # set breakpoint on "main" function
gdb> run # run -> performs memory relotion of code addresses
gdb> disasss main # view disass
Dump of assembler code for function main:
   0x0000555555555175 <+0>:	push   %rbp
   0x0000555555555176 <+1>:	mov    %rsp,%rbp
=> 0x0000555555555179 <+4>:	sub    $0x10,%rsp
   0x000055555555517d <+8>:	mov    $0x1,%esi
   0x0000555555555182 <+13>:	mov    $0x32,%edi
   0x0000555555555187 <+18>:	call   0x555555555060 <calloc@plt>
   0x000055555555518c <+23>:	mov    %rax,-0x8(%rbp)
   0x0000555555555190 <+27>:	lea    0xe71(%rip),%rdi        # 0x555555556008
   0x0000555555555197 <+34>:	call   0x555555555030 <puts@plt>
   0x000055555555519c <+39>:	mov    -0x8(%rbp),%rax
   0x00005555555551a0 <+43>:	mov    %rax,%rsi
   0x00005555555551a3 <+46>:	lea    0xe91(%rip),%rdi        # 0x55555555603b
   0x00005555555551aa <+53>:	mov    $0x0,%eax
   0x00005555555551af <+58>:	call   0x555555555070 <__isoc99_scanf@plt>
   0x00005555555551b4 <+63>:	mov    -0x8(%rbp),%rax
   0x00005555555551b8 <+67>:	mov    %rax,%rdi
   0x00005555555551bb <+70>:	call   0x5555555551ea <validate>
   0x00005555555551c0 <+75>:	test   %eax,%eax
   0x00005555555551c2 <+77>:	je     0x5555555551d7 <main+98>
   0x00005555555551c4 <+79>:	lea    0xe73(%rip),%rdi        # 0x55555555603e
   0x00005555555551cb <+86>:	call   0x555555555030 <puts@plt>
   0x00005555555551d0 <+91>:	mov    $0x0,%eax
   0x00005555555551e8 <+115>:	leave
   0x00005555555551e9 <+116>:	ret
End of assembler dump.

gdb> break *0x0000555555555197 # first puts() function call
gdb> run # run to breakpoint
gdb> info registers rdi # view the "rdi" register content
rdi            0x555555556008      93824992239624

gdb> x/s 0x555555556008  
# view string content at address stored in rdi
# "x/s $rdi" works too
0x555555556008:	"Welcome to the Salty Spitoonâ„¢, How tough are ya?"

```



