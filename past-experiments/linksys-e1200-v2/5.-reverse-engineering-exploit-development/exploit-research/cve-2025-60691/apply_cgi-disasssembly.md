# apply\_cgi disasssembly

```mipsasm
                         **************************************************************
                         *                          FUNCTION                          *
                         **************************************************************
                         undefined4 __stdcall apply_cgi(FILE * param_1, undefined
                           assume gp = 0x501050
                           assume t9 = 0x421a10
         undefined4        v0:4           <RETURN>
         FILE *            a0:4           param_1
         undefined4        a1:4           param_2
         undefined4        a2:4           param_3
         undefined4        a3:4           param_4
         undefined4        Stack[0x10]:4  param_5                                 XREF[1]:     00421b3c(R)  
         char *            Stack[0x14]:4  param_6                                 XREF[1]:     00421a68(R)  
         char *            Stack[0x18]:4  param_7                                 XREF[1]:     00421a6c(R)  
         undefined4        Stack[0x0]:4   local_res0                              XREF[26]:    00421a4c(W), 
                                                                                               00421b44(R), 
                                                                                               00421d24(R), 
                                                                                               00421d3c(R), 
                                                                                               00421d58(R), 
                                                                                               00421df8(R), 
                                                                                               00421e14(R), 
                                                                                               00422084(R), 
                                                                                               004220b0(R), 
                                                                                               00422118(R), 
                                                                                               0042214c(R), 
                                                                                               00422168(R), 
                                                                                               00422184(R), 
                                                                                               004222e4(R), 
                                                                                               00422314(R), 
                                                                                               00422334(R), 
                                                                                               00422378(R), 
                                                                                               004223c0(R), 
                                                                                               00422464(R), 
                                                                                               00422484(R)  
         undefined4        Stack[-0x4]:4  local_4                                 XREF[2]:     00421a20(W), 
                                                                                               00421b64(R)  
         undefined4        Stack[-0x8]:4  local_8                                 XREF[2]:     00421a24(W), 
                                                                                               00421b68(R)  
         undefined4        Stack[-0xc]:4  local_c                                 XREF[2]:     00421a28(W), 
                                                                                               00421b6c(R)  
         undefined4        Stack[-0x10]:4 local_10                                XREF[2]:     00421a2c(W), 
                                                                                               00421b70(R)  
         undefined4        Stack[-0x14]:4 local_14                                XREF[2]:     00421a30(W), 
                                                                                               00421b74(R)  
         undefined4        Stack[-0x18]:4 local_18                                XREF[2]:     00421a34(W), 
                                                                                               00421b78(R)  
         undefined4        Stack[-0x1c]:4 local_1c                                XREF[2]:     00421a38(W), 
                                                                                               00421b7c(R)  
         undefined4        Stack[-0x20]:4 local_20                                XREF[2]:     00421a3c(W), 
                                                                                               00421b80(R)  
         undefined4        Stack[-0x24]:4 local_24                                XREF[2]:     00421a40(W), 
                                                                                               00421b84(R)  
         undefined4        Stack[-0x28]:4 local_28                                XREF[2]:     00421a44(W), 
                                                                                               00421b88(R)  
         undefined4        Stack[-0x30]:4 local_30                                XREF[3]:     00421a98(W), 
                                                                                               00421e80(R), 
                                                                                               0042240c(R)  
         undefined4        Stack[-0x34]:4 local_34                                XREF[2]:     00421ad0(W), 
                                                                                               00422718(R)  
         undefined4        Stack[-0x38]:4 local_38                                XREF[4]:     00421aec(W), 
                                                                                               00421e90(R), 
                                                                                               00421ea8(R), 
                                                                                               00422294(R)  
         undefined1        Stack[-0x838   local_838                               XREF[2]:     00421bfc(W), 
                                                                                               00421f24(W)  
         undefined4        Stack[-0x840   local_840                               XREF[105]:   00421a48(W), 
                                                                                               00421a78(R), 
                                                                                               00421a94(R), 
                                                                                               00421ab0(R), 
                                                                                               00421acc(R), 
                                                                                               00421ae8(R), 
                                                                                               00421b0c(R), 
                                                                                               00421b30(R), 
                                                                                               00421b60(R), 
                                                                                               00421bac(R), 
                                                                                               00421be0(R), 
                                                                                               00421c0c(R), 
                                                                                               00421c28(R), 
                                                                                               00421c44(R), 
                                                                                               00421c60(R), 
                                                                                               00421c7c(R), 
                                                                                               00421c98(R), 
                                                                                               00421cb4(R), 
                                                                                               00421cd0(R), 
                                                                                               00421cec(R)  
         undefined4        Stack[-0x848   local_848                               XREF[1]:     00421b50(W)  
         undefined4        Stack[-0x84c   local_84c                               XREF[2]:     00421b4c(W), 
                                                                                               0042265c(W)  
         undefined4        Stack[-0x850   local_850                               XREF[2]:     00421b48(W), 
                                                                                               00422640(W)  
                         apply_cgi                                       XREF[2]:     Entry Point(*), 004f9fc4(*)  
    00421a10 0e 00 1c 3c     lui        gp,0xe
         assume t9 = <UNKNOWN>
         assume gp = <UNKNOWN>
    00421a14 40 f6 9c 27     addiu      gp,gp,-0x9c0
    00421a18 21 e0 99 03     addu       gp,gp,t9
    00421a1c a0 f7 bd 27     addiu      sp,sp,-0x860
    00421a20 5c 08 bf af     sw         ra,local_4(sp)
    00421a24 58 08 be af     sw         s8,local_8(sp)
    00421a28 54 08 b7 af     sw         s7,local_c(sp)
    00421a2c 50 08 b6 af     sw         s6,local_10(sp)
    00421a30 4c 08 b5 af     sw         s5,local_14(sp)
    00421a34 48 08 b4 af     sw         s4,local_18(sp)
    00421a38 44 08 b3 af     sw         s3,local_1c(sp)
    00421a3c 40 08 b2 af     sw         s2,local_20(sp)
    00421a40 3c 08 b1 af     sw         s1,local_24(sp)
    00421a44 38 08 b0 af     sw         s0,local_28(sp)
    00421a48 20 00 bc af     sw         gp=>_gp,local_840(sp)                            = ??
    00421a4c 60 08 a4 af     sw         param_1,local_res0(sp)
    00421a50 28 80 84 8f     lw         param_1,-0x7fd8(gp)=>PTR_s_va_004f9078           = 004a0000
    00421a54 64 88 99 8f     lw         t9,-0x779c(gp)=>->get_cgi                        = 0040fa34
    00421a58 70 f2 84 24     addiu      param_1=>s_need_reboot_0049f270,param_1,-0xd90   = "need_reboot"
    00421a5c 21 88 20 03     move       s1,t9
    00421a60 21 b0 a0 00     move       s6,param_2
    00421a64 21 b8 c0 00     move       s7,param_3
    00421a68 74 08 b4 8f     lw         s4,param_6(sp)
    00421a6c 78 08 b5 8f     lw         s5,param_7(sp)
    00421a70 09 f8 20 03     jalr       t9=>get_cgi                                      int get_cgi(ACTION param_1)
    00421a74 21 f0 e0 00     _move      s8,param_4
    00421a78 20 00 bc 8f     lw         gp,local_840(sp)
    00421a7c ee 01 40 10     beq        v0,zero,LAB_00422238
```
